---
title: μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦ (μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”© ν…μ¤νΈλ‹¤)
date: 2022-03-09 02:23 +0900
lastmod: 2022-03-09 02:23 +0900
categories: [algorithm]
tags: [algorithm, μµλ‹¨κ²½λ΅, μ΄μ½”ν…]
mermaid: true
math: true
---

> [μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”© ν…μ¤νΈλ‹¤](https://www.youtube.com/playlist?list=PLRx0vPvlEmdAghTr5mXQxGpHjWqSz0dgC)λ¥Ό μ •λ¦¬ν• κΈ€μ…λ‹λ‹¤.

# μµλ‹¨ κ²½λ΅ λ¬Έμ 

κ°€μ¥ μ§§μ€ κ²½λ΅λ¥Ό μ°Ύλ” μ•κ³ λ¦¬μ¦μ΄λ‹¤. κ° μ§€μ μ€ κ·Έλν”„μ—μ„ λ…Έλ“λ΅ ν‘ν„μ΄ λκ³  μ§€μ  κ°„ μ—°κ²°λ λ„λ΅λ” κ·Έλν”„μ—μ„ κ°„μ„ μΌλ΅ ν‘ν„λλ‹¤.

μµλ‹¨ κ²½λ΅ λ¬Έμ λ” λ‹¤μ•™ν• λ¬Έμ  μƒν™©μ΄ μλ‹¤.

- ν• μ§€μ μ—μ„ λ‹¤λ¥Έ ν• μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅
- ν• μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅
- λ¨λ“  μ§€μ μ—μ„ λ‹¤λ¥Έ λ¨λ“  μ§€μ κΉμ§€μ μµλ‹¨ κ²½λ΅

# λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦

νΉμ •ν• λ…Έλ“μ—μ„ μ¶λ°ν•μ—¬ λ‹¤λ¥Έ λ¨λ“  λ…Έλ“λ΅ κ°€λ” μµλ‹¨ κ²½λ΅λ¥Ό κ³„μ‚°ν•λ‹¤. λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ€ μμ κ°„μ„ μ΄ μ—†μ„ λ€ μ •μƒμ μΌλ΅ λ™μ‘ν•λ‹¤.

λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ€ κ·Έλ¦¬λ”” μ•κ³ λ¦¬μ¦μΌλ΅ λ¶„λ¥λλ©° λ§¤ μƒν™©μ—μ„ κ°€μ¥ λΉ„μ©μ΄ μ μ€ λ…Έλ“λ¥Ό μ„ νƒν•΄μ„ μ„μμ κ³Όμ •μ„ λ°λ³µν•λ‹¤.

## λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ λ™μ‘ κ³Όμ •

1. μ¶λ° λ…Έλ“λ¥Ό μ„¤μ •ν•λ‹¤.
2. μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ μ΄κΈ°ν™” ν•λ‹¤.
3. λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό μ„ νƒν•λ‹¤.
4. ν•΄λ‹Ή λ…Έλ“λ¥Ό κ±°μ³ λ‹¤λ¥Έ λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ„ κ³„μ‚°ν•μ—¬ μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ κ°±μ‹ γ…‡ν•λ‹¤.
5. 3κ³Ό 4λ¥Ό λ°λ³µν•λ‹¤.

<details>
<summary style='color: #4C3F91; font-weight:bold;'>λ‹¤μµμ¤λ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦ μμ  μ½”λ“</summary>
<div markdown='1'>

```python
import sys
input = sys.stdin.readline
# > ν…μ΄λΈ” μ΄κΈ°ν™” μ‹
INF = int(1e9)  # λ¬΄ν•μ„ μλ―Έν•λ” κ°’μΌλ΅ 10μ–µμ„ μ„¤μ •

# λ…Έλ“μ κ°μ, κ°„μ„ μ κ°μλ¥Ό μ…λ ¥λ°›κΈ°
n, m = map(int, input().split())
# μ‹μ‘ λ…Έλ“ λ²νΈλ¥Ό μ…λ ¥λ°›κΈ°
start = int(input())
# κ° λ…Έλ“μ— μ—°κ²°λμ–΄ μλ” λ…Έλ“μ— λ€ν• μ •λ³΄λ¥Ό λ‹΄λ” λ¦¬μ¤νΈλ¥Ό λ§λ“¤κΈ°
graph = [[] for i in range(n + 1)]
# λ°©λ¬Έν• μ μ΄ μλ”μ§€ μ²΄ν¬ν•λ” λ©μ μ λ¦¬μ¤νΈλ¥Ό λ§λ“¤κΈ°
visited = [False] * (n + 1)
# μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ λ¨λ‘ λ¬΄ν•μΌλ΅ μ΄κΈ°ν™”
distance = [INF] * (n + 1)

# λ¨λ“  κ°„μ„  μ •λ³΄λ¥Ό μ…λ ¥λ°›κΈ°
for _ in range(m):
    a, b, c = map(int, input().split())
    # aλ² λ…Έλ“μ—μ„ bλ² λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ΄ cλΌλ” μλ―Έ
    graph[a].append((b, c))

# λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ—μ„, κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“μ λ²νΈλ¥Ό λ°ν™


def get_smallest_node():
    min_value = INF
    index = 0  # κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“(μΈλ±μ¤)
    for i in range(1, n + 1):
        if distance[i] < min_value and not visited[i]:
            min_value = distance[i]
            index = i
    return index


def dijkstra(start):
    # μ‹μ‘ λ…Έλ“μ— λ€ν•΄μ„ μ΄κΈ°ν™”
    distance[start] = 0
    visited[start] = True
    for j in graph[start]:
        distance[j[0]] = j[1]
    # μ‹μ‘ λ…Έλ“λ¥Ό μ μ™Έν• μ „μ²΄ n - 1κ°μ λ…Έλ“μ— λ€ν•΄ λ°λ³µ
    for i in range(n - 1):
        # ν„μ¬ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό κΊΌλ‚΄μ„, λ°©λ¬Έ μ²λ¦¬
        now = get_smallest_node()
        visited[now] = True
        # ν„μ¬ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ λ…Έλ“λ¥Ό ν™•μΈ
        for j in graph[now]:
            cost = distance[now] + j[1]
            # ν„μ¬ λ…Έλ“λ¥Ό κ±°μ³μ„ λ‹¤λ¥Έ λ…Έλ“λ΅ μ΄λ™ν•λ” κ±°λ¦¬κ°€ λ” μ§§μ€ κ²½μ°
            if cost < distance[j[0]]:
                distance[j[0]] = cost


# λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μν–‰
dijkstra(start)

# λ¨λ“  λ…Έλ“λ΅ κ°€κΈ° μ„ν• μµλ‹¨ κ±°λ¦¬λ¥Ό μ¶λ ¥
for i in range(1, n + 1):
    # λ„λ‹¬ν•  μ μ—†λ” κ²½μ°, λ¬΄ν•(INFINITY)μ΄λΌκ³  μ¶λ ¥
    if distance[i] == INF:
        print("INFINITY")
    # λ„λ‹¬ν•  μ μλ” κ²½μ° κ±°λ¦¬λ¥Ό μ¶λ ¥
    else:
        print(distance[i])

```

</div>
</details>

## λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦ μ„±λ¥ λ¶„μ„

μ΄ $O(V)$λ²μ— κ±Έμ³ μµλ‹¨ κ±°λ¦¬κ°€ κ°€μ¥ μ§§μ€ λ…Έλ“λ¥Ό λ§¤λ² μ„ ν• νƒμƒ‰ν•΄μ•Ό ν•λ‹¤. ν„μ¬ λ…Έλ“μ™€ μ—°κ²°λ λ…Έλ“λ¥Ό λ§¤λ² ν™•μΈν•΄μ•Όλλ―€λ΅ μ‹κ°„ λ³µμ΅λ„λ” $O(V^2)$μ΄λ‹¤.

λ¬Έμ μ—μ„ λ…Έλ“μ κ°μκ°€ 5,000κ° μ΄ν•λΌλ©΄ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•  μ μμ§€λ§, 10,000κ°λ¥Ό λ„μ–΄κ°€λ” λ¬Έμ μ—μ„λ” ν•΄κ²°ν•κΈ° νλ“¤λ‹¤. μ΄λ¥Ό ν•΄κ²°ν•  μ μλ” κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μ•μ•„λ³΄μ.

# κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦

κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ—μ„λ” `heap`μλ£κµ¬μ΅°λ¥Ό μ‚¬μ©ν•λ‹¤. νΉμ • λ…Έλ“κΉμ§€μ μµλ‹¨ κ±°λ¦¬μ— λ€ν• μ •λ³΄λ¥Ό ν™μ— λ‹΄μ•„ μ²λ¦¬ν•κΈ° λ•λ¬Έμ— μ¶λ° λ…Έλ“λ΅λ¶€ν„° κ°€μ¥ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“λ¥Ό λ”μ± λΉ λ¥΄κ² μ°Ύμ„ μ μλ‹¤.

## Heap

`heap`μλ£κµ¬μ΅°λ” μ°μ„ μμ„ νλ¥Ό κµ¬ν„ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ” μλ£κµ¬μ΅° μ¤‘ ν•λ‚μ΄λ‹¤. μ°μ„ μμ„ νλ” μ°μ„ μμ„κ°€ κ°€μ¥ λ†’μ€ λ°μ΄ν„°λ¥Ό λ¨Όμ € μ‚­μ ν•λ” νΉμ§•μ„ κ°€μ§€κ³  μλ‹¤. νμ΄μ¬μ—λ” μ°μ„  μμ„ νλ¥Ό μ‚¬μ©ν•  μ μλ” `PriorityQueue`ν΄λμ¤μ™€ `heapq`λ¨λ“μ΄ μλ‹¤. λ‘ κ°€μ§€μ λΌμ΄λΈλ¬λ¦¬μ μ°¨μ΄λ¥Ό μ„¤λ…ν• λ‚΄μ©μ€ μ•„λμ—μ„ ν™•μΈν•  μ μλ‹¤.

<a href="https://nowgnas.github.io/posts/algo11/#%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EC%A0%84%EC%97%AD-%EC%9D%B8%ED%84%B0%ED%94%84%EB%A6%AC%ED%84%B0-%EB%9D%BDgil"><img src='/assets/img/profiles.png' style='width:15%; box-shadow: 5px 5px 5px #313552;' />
</a>

<p style='color: #4C3F91; font-weight:bold;1A374D; font-weight: bold;'>π‘†PriorityQueueμ™€ heapq</p>

`heap`μλ£κµ¬μ΅°μ—λ” μµμ† ν™κ³Ό μµλ€ ν™μ΄ μλ‹¤. μµμ† ν™μ€ κ°€μ¥ μ‘μ€ λ°μ΄ν„°κ°€ μ°μ„ μΌλ΅ μ‚­μ λλ©° μµλ€ ν™μ€ κ°€μ¥ ν° λ°μ΄ν„°κ°€ λ¨Όμ € μ‚­μ  λλ‹¤. λ‹¤μµμ¤νΈλΌ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦μ—μ„λ” λΉ„μ©μ΄ μ μ€ λ…Έλ“λ¥Ό μ°μ„ μΌλ΅ ν•μ—¬ λ°©λ¬Έν•κΈ° λ•λ¬Έμ— μµμ† ν™ κµ¬μ΅°μ μ°μ„ μμ„ νλ¥Ό μ‚¬μ©ν•λ©΄ μ ν•©ν•λ‹¤.

<details>
<summary style='color: #4C3F91; font-weight:bold;'>μµμ† ν™</summary>
<div markdown='1'>

```python
import heapq

# μµμ† ν™

def heapsort(iterable):
    h = []
    result = []

    # λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ ν™μ— μ‚½μ…
    for value in iterable:
        heapq.heappush(h, value)
    # ν™μ— μ‚½μ…λ λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ κΊΌλ‚΄κΈ°
    for i in range(len(h)):
        result.append(heapq.heappop(h))
    return result

result = heapsort([1, 3, 5, 7, 9, 2, 4, 6, 8, 0])
print(result)
```

</div>
</details>

<details>
<summary style='color: #4C3F91; font-weight:bold;'>μµλ€ ν™</summary>
<div markdown='1'>

```python
import heapq

# μµμ† ν™

def heapsort(iterable):
    h = []
    result = []

    # λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ ν™μ— μ‚½μ…
    for value in iterable:
        heapq.heappush(h, -value)
    # ν™μ— μ‚½μ…λ λ¨λ“  μ›μ†λ¥Ό μ°¨λ΅€λ€λ΅ κΊΌλ‚΄κΈ°
    for i in range(len(h)):
        result.append(-heapq.heappop(h))
    return result

result = heapsort([1, 3, 5, 7, 9, 2, 4, 6, 8, 0])
print(result)
```

</div>
</details>

## κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ λ™μ‘

λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦κ³Ό κΈ°λ³Έ μ›λ¦¬λ” λ™μΌν•μ§€λ§, ν„μ¬ κ°€μ¥ κ°€κΉμ΄ λ…Έλ“λ¥Ό μ €μ¥ν•΄ λ†“κΈ° μ„ν•΄μ„ ν™ μλ£κµ¬μ΅°λ¥Ό μ¶”κ°€λ΅ μ‚¬μ©ν•λ” λ¶€λ¶„μ΄ λ‹¤λ¥΄λ‹¤.

### μ΄κΈ° μƒνƒ

![μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤](/assets/img/posts/usually/post9/Untitled.png)

μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤

μ¶λ° λ…Έλ“λ¥Ό 1λ΅ μ„¤μ •ν•κ³  μ¶λ° λ…Έλ“λ¥Ό μ μ™Έν• λ¨λ“  λ…Έλ“μ κ±°λ¦¬λ¥Ό `λ¬΄ν•`μΌλ΅ μ΄κΈ°ν™” ν•΄μ¤€λ‹¤. μ°μ„  μμ„ νμ— νν” ν•μ‹μΌλ΅ `(κ±°λ¦¬, λ…Έλ“)`λ¥Ό λ„£κ² λκ³  `(0, 1)`μ„ μ¶”κ°€ν•κ² λλ‹¤. ν„μ¬ μ°μ„ μμ„ νμ—λ” ν•λ‚μ νν”μ΄ μ΅΄μ¬ν•λ‹¤.

### Step1

![μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤](/assets/img/posts/usually/post9/Untitled1.png)

μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤

μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλ‚΄ λ°©λ¬Έ μ²λ¦¬λ¥Ό ν•΄μ¤€λ‹¤. κΊΌλ‚Έ μ›μ†λ” `(0, 1)`μ΄λ©°, λ…Έλ“ 1κ³Ό μ΄μ›ƒμΈ λ…Έλ“λ” 4, 2, 3μ΄ μ΅΄μ¬ν•λ‹¤. κ° λ…Έλ“λ“¤μ κ±°λ¦¬μ™€ λ…Έλ“ λ²νΈλ¥Ό μ°μ„ μμ„ νμ— λ„£μ–΄μ£Όλ©° κ° λ…Έλ“ κΉμ§€μ κ±°λ¦¬λ¥Ό κ°±μ‹ ν•΄ μ¤€λ‹¤.

### Step2

![μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤](/assets/img/posts/usually/post9/Untitled2.png)

μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤

`step1`μ μ°μ„ μμ„ νμ—μ„ μ›μ†λ¥Ό κΊΌλ‚΄ λ°©λ¬Έ μ²λ¦¬λ¥Ό ν•λ‹¤. κΊΌλ‚΄μ§„ μ›μ†λ” `(1, 4)`κ°€ λκ³ , μΈμ ‘ν• μ›μ†λ“¤μ„ ν™•μΈν•λ‹¤. μΈμ ‘ν• μ›μ†λ” 3κ³Ό 5μ΄λ©°, 4λ² λ…Έλ“λ¥Ό κ±°μ³κ°€λ” κ²½μ° 4λ² λ…Έλ“μ κ±°λ¦¬ 1κ³Ό 4λ²μ—μ„ κ° λ…Έλ“κΉμ§€μ κ±°λ¦¬λ¥Ό λ”ν•λ‹¤. λ”ν•΄μ§„ κ°’λ“¤κ³Ό μ΄μ „ λ‹¨κ³„μ κ±°λ¦¬λ¥Ό λΉ„κµν•΄ μ‘μ€ κ°’μΌλ΅ κ°±μ‹ ν•κ² λλ‹¤. ν™•μΈν• λ…Έλ“λ“¤μ„ μ°μ„ μμ„ νμ— λ„£μ–΄μ£Όκ² λκ³  κ±°λ¦¬κ°€ μ‘μ€ νν”μ΄ μ°μ„ μμ„λ¥Ό κ°€μ§€κ² λλ‹¤. μ΄ν›„μ λ‹¨κ³„λ“¤μ€ μ•μ„ λ΄¤λ λ™μ‘κ³Ό λ™μΌν•λ‹¤.

<details>
<summary style='color: #4C3F91; font-weight:bold;'>κ°μ„ λ μµλ‹¨ κ²½λ΅ μ•κ³ λ¦¬μ¦</summary>
<div markdown='1'>

```python
import heapq
import sys
input = sys.stdin.readline
INF = int(1e9)  # λ¬΄ν•μ„ μλ―Έν•λ” κ°’μΌλ΅ 10μ–µμ„ μ„¤μ •

# λ…Έλ“μ κ°μ, κ°„μ„ μ κ°μλ¥Ό μ…λ ¥λ°›κΈ°
n, m = map(int, input().split())
# μ‹μ‘ λ…Έλ“ λ²νΈλ¥Ό μ…λ ¥λ°›κΈ°
start = int(input())
# κ° λ…Έλ“μ— μ—°κ²°λμ–΄ μλ” λ…Έλ“μ— λ€ν• μ •λ³΄λ¥Ό λ‹΄λ” λ¦¬μ¤νΈλ¥Ό λ§λ“¤κΈ°
graph = [[] for i in range(n + 1)]
# μµλ‹¨ κ±°λ¦¬ ν…μ΄λΈ”μ„ λ¨λ‘ λ¬΄ν•μΌλ΅ μ΄κΈ°ν™”
distance = [INF] * (n + 1)

# λ¨λ“  κ°„μ„  μ •λ³΄λ¥Ό μ…λ ¥λ°›κΈ°
for _ in range(m):
    a, b, c = map(int, input().split())
    # aλ² λ…Έλ“μ—μ„ bλ² λ…Έλ“λ΅ κ°€λ” λΉ„μ©μ΄ cλΌλ” μλ―Έ
    graph[a].append((b, c))

def dijkstra(start):
    q = []
    # μ‹μ‘ λ…Έλ“λ΅ κ°€κΈ° μ„ν• μµλ‹¨ κ²½λ΅λ” 0μΌλ΅ μ„¤μ •ν•μ—¬, νμ— μ‚½μ…
    heapq.heappush(q, (0, start))
    distance[start] = 0
    while q:  # νκ°€ λΉ„μ–΄μμ§€ μ•λ‹¤λ©΄
        # κ°€μ¥ μµλ‹¨ κ±°λ¦¬κ°€ μ§§μ€ λ…Έλ“μ— λ€ν• μ •λ³΄ κΊΌλ‚΄κΈ°
        dist, now = heapq.heappop(q)
        # ν„μ¬ λ…Έλ“κ°€ μ΄λ―Έ μ²λ¦¬λ μ μ΄ μλ” λ…Έλ“λΌλ©΄ λ¬΄μ‹
        if distance[now] < dist:
            continue
        # ν„μ¬ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ μΈμ ‘ν• λ…Έλ“λ“¤μ„ ν™•μΈ
        for i in graph[now]:
            cost = dist + i[1]
            # ν„μ¬ λ…Έλ“λ¥Ό κ±°μ³μ„, λ‹¤λ¥Έ λ…Έλ“λ΅ μ΄λ™ν•λ” κ±°λ¦¬κ°€ λ” μ§§μ€ κ²½μ°
            if cost < distance[i[0]]:
                distance[i[0]] = cost
                heapq.heappush(q, (cost, i[0]))

# λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦μ„ μν–‰
dijkstra(start)

# λ¨λ“  λ…Έλ“λ΅ κ°€κΈ° μ„ν• μµλ‹¨ κ±°λ¦¬λ¥Ό μ¶λ ¥
for i in range(1, n + 1):
    # λ„λ‹¬ν•  μ μ—†λ” κ²½μ°, λ¬΄ν•(INFINITY)μ΄λΌκ³  μ¶λ ¥
    if distance[i] == INF:
        print("INFINITY")
    # λ„λ‹¬ν•  μ μλ” κ²½μ° κ±°λ¦¬λ¥Ό μ¶λ ¥
    else:
        print(distance[i])
```

### μ…λ ¥

```bash
6 11
1
1 2 2
1 3 5
1 4 1
2 3 3
2 4 2
3 2 3
3 6 5
4 3 3
4 5 1
5 3 1
5 6 2
```

### μ¶λ ¥

```bash
0
2
3
1
2
4
```

</div>
</details>

## κ°μ„ λ λ‹¤μµμ¤νΈλΌ μ•κ³ λ¦¬μ¦ μ„±λ¥ λ¶„μ„

λ…Έλ“λ¥Ό ν•λ‚μ”© κΊΌλ‚΄μ„ κ²€μ‚¬ν•λ” λ°λ³µλ¬Έμ€ λ…Έλ“μ κ°μ `V`μ΄μƒμΌλ΅λ” μ²λ¦¬λμ§€ μ•λ”λ‹¤. ν•λ² λ°©λ¬Έν–λ λ…Έλ“λ” ν™•μΈν•μ§€ μ•κΈ° λ•λ¬Έμ΄λ‹¤. κ·Έλ¬λ―€λ΅ ν„μ¬ μ°μ„ μμ„ νμ—μ„ κΊΌλ‚Έ λ…Έλ“μ™€ μ—°κ²°λ λ‹¤λ¥Έ λ…Έλ“λ“¤μ„ ν™•μΈν•λ” μ΄ νμλ” μµλ€ κ°„μ„  κ°μ `E`λ§νΌ μ—°μ‚°μ΄ μν–‰λ  μ μλ‹¤. λ”°λΌμ„ `E`κ°μ μ›μ†λ¥Ό μ°μ„ μμ„ νμ— λ„£μ—λ‹¤κ°€ λΉΌλ” μ—°μ‚°κ³Ό μ μ‚¬ν•λ©°, μ‹κ°„λ³µμ΅λ„λ” $O(ElogV)$λ΅ λ³Ό μ μλ‹¤.

# ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦

λ¨λ“  λ…Έλ“μ—μ„ λ‹¤λ¥Έ λ…Έλ“κΉμ§€μ μµλ‹¨ κ²½λ΅λ¥Ό λ¨λ‘ κ³„μ‚°ν•λ” μ•κ³ λ¦¬μ¦μ΄λ‹¤. λ‹¨κ³„λ³„λ΅ κ±°μ³κ°€λ” λ…Έλ“λ¥Ό κΈ°μ¤€μΌλ΅ λ™μ‘ν•λ‹¤. 2μ°¨μ› ν…μ΄λΈ”μ— μµλ‹¨ κ±°λ¦¬ μ •λ³΄λ¥Ό μ €μ¥ν•λ©°, λ§¤ λ‹¨κ³„λ§λ‹¤ λ°©λ¬Έν•μ§€ μ•μ€ λ…Έλ“ μ¤‘μ— μµλ‹¨ κ±°λ¦¬λ¥Ό κ°–λ” λ…Έλ“λ¥Ό μ°Ύλ” κ³Όμ •μ΄ ν•„μ”ν•μ§€ μ•λ‹¤.

κ° λ‹¨κ³„λ§λ‹¤ νΉμ • λ…Έλ“ `k`λ¥Ό κ±°μ³ κ°€λ” κ²½μ°λ¥Ό ν™•μΈν•λ‹¤. `a`μ—μ„ `b`λ΅ κ°€λ” μµλ‹¨ κ±°λ¦¬λ³΄λ‹¤ `a`μ—μ„ `k`λ¥Ό κ±°μ³ `b`λ΅ κ°€λ” κ±°λ¦¬κ°€ λ” μ§§μ€μ§€ κ²€μ‚¬ν•λ‹¤. μ ν™”μ‹μ€ μ•„λμ™€ κ°™λ‹¤

$$
D_{ab} = min(D_{ab}, D_{ak}+D_{kb})
$$

### μ΄κΈ° μƒνƒ

![μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤](/assets/img/posts/usually/post9/Untitled3.png)

μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤

λ‹¨μν•κ² κ° λ…Έλ“λ¥Ό κΈ°μ¤€μΌλ΅ μΈμ ‘ λ…Έλ“λ¥Ό 2μ°¨μ› ν…μ΄λΈ”μ— μ €μ¥ν•κ² λλ‹¤. ν–‰μ€ μ¶λ°λ…Έλ“, μ—΄μ€ λ„μ°© λ…Έλ“λ¥Ό μλ―Έν•λ‹¤.

### Step1

![μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤](/assets/img/posts/usually/post9/Untitled4.png)

μ΄κ²ƒμ΄ μ·¨μ—…μ„ μ„ν• μ½”λ”©ν…μ¤νΈλ‹¤

ν•λμƒ‰ λ¶€λ¶„μ€ κ°±μ‹ λλ” κ°’λ“¤μ΄λ‹¤. 1μ—μ„ κ° μ μλ” λ¶€λ¶„μ— λ€ν•΄ μµμ† λΉ„μ©μ„ κ³„μ‚°ν• κ²ƒμ΄λ‹¤. 1λ²μ„ κ±°μ³κ° κ²½μ°λ¥Ό ν™•μΈν•΄μ„ μµλ‹¨ κ±°λ¦¬λ¥Ό ν…μ΄λΈ”μ— κ°±μ‹ ν•λ‹¤. κ°κ°μ λ…Έλ“λ¥Ό λ°©λ¬Έν•λ©° ν…μ΄λΈ” κ°’λ“¤μ„ κ°±μ‹ ν•΄ λ‚κ°„λ‹¤.

<details>
<summary style='color: #4C3F91; font-weight:bold;'>ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦ μ½”λ“</summary>
<div markdown='1'>

```python
INF = int(1e9) # λ¬΄ν•μ„ μλ―Έν•λ” κ°’μΌλ΅ 10μ–µμ„ μ„¤μ •

# λ…Έλ“μ κ°μ λ° κ°„μ„ μ κ°μλ¥Ό μ…λ ¥λ°›κΈ°
n = int(input())
m = int(input())
# 2μ°¨μ› λ¦¬μ¤νΈ(κ·Έλν”„ ν‘ν„)λ¥Ό λ§λ“¤κ³ , λ¨λ“  κ°’μ„ λ¬΄ν•μΌλ΅ μ΄κΈ°ν™”
graph = [[INF] * (n + 1) for _ in range(n + 1)]

# μκΈ° μμ‹ μ—μ„ μκΈ° μμ‹ μΌλ΅ κ°€λ” λΉ„μ©μ€ 0μΌλ΅ μ΄κΈ°ν™”
for a in range(1, n + 1):
    for b in range(1, n + 1):
        if a == b:
            graph[a][b] = 0

# κ° κ°„μ„ μ— λ€ν• μ •λ³΄λ¥Ό μ…λ ¥ λ°›μ•„, κ·Έ κ°’μΌλ΅ μ΄κΈ°ν™”
for _ in range(m):
    # Aμ—μ„ Bλ΅ κ°€λ” λΉ„μ©μ€ CλΌκ³  μ„¤μ •
    a, b, c = map(int, input().split())
    graph[a][b] = c

# μ ν™”μ‹μ— λ”°λΌ ν”λ΅μ΄λ“ μ›μ… μ•κ³ λ¦¬μ¦μ„ μν–‰
for k in range(1, n + 1):
    for a in range(1, n + 1):
        for b in range(1, n + 1):
            graph[a][b] = min(graph[a][b], graph[a][k] + graph[k][b])

# μν–‰λ κ²°κ³Όλ¥Ό μ¶λ ¥
for a in range(1, n + 1):
    for b in range(1, n + 1):
        # λ„λ‹¬ν•  μ μ—†λ” κ²½μ°, λ¬΄ν•(INFINITY)μ΄λΌκ³  μ¶λ ¥
        if graph[a][b] == 1e9:
            print("INFINITY", end=" ")
        # λ„λ‹¬ν•  μ μλ” κ²½μ° κ±°λ¦¬λ¥Ό μ¶λ ¥
        else:
            print(graph[a][b], end=" ")
    print()
```

</div>
</details>
